<p-table #dt [rowsPerPageOptions]="[10, 25, 50]" [rows]="10" [paginator]="true"
    currentPageReportTemplate="{first} - {last} de {totalRecords}" [filterDelay]="0" [showCurrentPageReport]="true"
    [showFirstLastIcon]="false" [value]="horarios" dataKey="maquinas-registradas"
    [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template pTemplate="caption">
        <div class="flex gap-3">
            <p-button [outlined]="true" icon="pi pi-filter-slash" label="" />
            <input pInputText type="text" placeholder="Buscar Rol" />
        </div>
    </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th>Nombres Rol</th>
            <th>Jornada</th>
            <th>Horas</th>
            <th>DÃ­as</th>
            <th>Acciones</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-horario>
        <tr>
            <td>{{ horario.rol.nombre }}</td>
            <td>{{ horario.jornada }}</td>
            <td>{{ horario.hora_inicio | slice:0:5 }} - {{ horario.hora_fin | slice:0:5 }}</td>
            <td>{{ horario.dia_semana }}</td>
            <td>
                <div class="flex gap-3 w-full justify-content-center">
                    <p-button [outlined]="true" size="small" severity="primary" (click)="showDialog(horario.id)" class="w-min"><mage-icon name="edit"
                            color="#059669" size="16px"></mage-icon>&nbsp;Editar</p-button>
                    <p-button [outlined]="true" (onClick)="confirm(horario.id)" size="small" severity="danger"
                        class="w-min"><mage-icon name="delete" stroke="#D32F2F"
                            size="16px"></mage-icon>&nbsp;Eliminar</p-button>
                </div>
            </td>
        </tr>
    </ng-template>
</p-table>

<p-confirmDialog #cd>
    <ng-template pTemplate="headless" let-message>
        <div class="flex flex-column align-items-center p-5 surface-overlay border-round">
            <div style="background-color: red; color: white"
                class="border-circle bg-primary inline-flex justify-content-center align-items-center h-6rem w-6rem">
                <mage-icon name="delete" stroke="#D32F2F" size="16px"></mage-icon>
            </div>
            <span class="font-bold text-2xl block mb-2 mt-4">
                {{ message.header }}
            </span>
            <p class="mb-0">{{ message.message }}</p>
            <div class="flex align-items-center gap-2 mt-4">
                <button pButton label="Save" (click)="cd.accept()" class="w-8rem">
                </button>
                <button pButton label="Cancel" (click)="cd.reject()" class="p-button-outlined w-8rem ">
                </button>
            </div>
        </div>
    </ng-template>
</p-confirmDialog>

<p-dialog header="Actualizar ejercicio" [(visible)]="visible" [modal]="true"
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [style]="{ width: '50vw' }" [draggable]="false"
    [resizable]="false">
    <form [formGroup]="horarioForm" (ngSubmit)="onSubmit()">
        <div style="width: calc(50% - 10px)">
            <input type="hidden" formControlName="id" />
            <label for="rol_id" class="">Roles</label>
            <p-dropdown formControlName="rol_id" optionLabel="name" [options]="roles" placeholder="Seleccione un rol"
                [ngClass]="{ 'ng-dirty ng-invalid': horarioForm.getError('rol_id') }" />
            <small *ngIf="horarioForm.getError('rol_id')" class="ng-invalid text-red-600">
                {{ horarioForm.getError("rol_id") }}
            </small>
        </div>
        <div style="width: calc(50% - 10px)">
            <label for="dia_semana" class="">Dias de semana</label>
            <p-dropdown formControlName="dia_semana" optionLabel="name" [options]="dias"
                placeholder="Seleccione un dia de semana"
                [ngClass]="{ 'ng-dirty ng-invalid': horarioForm.getError('dia_semana') }" />
            <small *ngIf="horarioForm.getError('dia_semana')" class="ng-invalid text-red-600">
                {{ horarioForm.getError("dia_semana") }}
            </small>
        </div>
        <div style="width: calc(35% - 15px)">
            <label for="hora_inicio" class="">Hora de ingreso</label>
            <p-dropdown formControlName="hora_inicio" optionLabel="name" [options]="horas"
                placeholder="Seleccione una hora"
                [ngClass]="{ 'ng-dirty ng-invalid': horarioForm.getError('hora_inicio') }" />
            <small *ngIf="horarioForm.getError('hora_inicio')" class="ng-invalid text-red-600">
                {{ horarioForm.getError("hora_inicio") }}
            </small>
        </div>
        <div style="width: calc(35% - 15px)">
            <label for="hora_fin" class="">Hora de salida</label>
            <p-dropdown formControlName="hora_fin" optionLabel="name" [options]="horasSalida"
                placeholder="Seleccione una hora"
                [ngClass]="{ 'ng-dirty ng-invalid': horarioForm.getError('hora_fin') }" />
            <small *ngIf="horarioForm.getError('hora_fin')" class="ng-invalid text-red-600">
                {{ horarioForm.getError("hora_fin") }}
            </small>
        </div>
        <div style="width: calc(30% - 10px)">
            <label for="jornada" class="">Jornada</label>
            <p-dropdown formControlName="jornada" optionLabel="name" [options]="jornada"
                placeholder="Seleccione una hora"
                [ngClass]="{ 'ng-dirty ng-invalid': horarioForm.getError('jornada') }" />
            <small *ngIf="horarioForm.getError('jornada')" class="ng-invalid text-red-600">
                {{ horarioForm.getError("jornada") }}
            </small>
        </div>
        <!-- <div style="width: calc(50% - 10px)">
              <label for="ingreso" class="">Hora de ingreso</label>
               <p-dropdown formControlName="ingreso" optionLabel="name" [options]="ingresoOpt"
                  placeholder="Seleccione una hora" [ngModel]="ingresoOpt[0]"
                  [ngClass]="{'ng-dirty ng-invalid': horarioForm.getError('ingreso')}" />
              <small *ngIf="horarioForm.getError('ingreso')" class="ng-invalid text-red-600">
                  {{ horarioForm.getError('ingreso') }}
              </small> 
          </div> -->
        <div style="
            display: flex;
            gap: 20px;
            width: 100%;
            justify-content: end;
            margin-top: 10px;
          ">
            <p-button (onClick)="closedDialog()" [outlined]="true" label="Cancelar" id="reset" />
            <p-button type="submit" label="Actualizar" id="guardar" />
        </div>
    </form>
</p-dialog>